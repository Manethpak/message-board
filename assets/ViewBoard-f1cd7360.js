import{S as ne,i as se,s as oe,e as p,c as C,D as F,v as E,w as Q,t as B,g as A,G as ie,H as re,K as we,J as R,E as U,L as Ie,b as m,n as z,a as j,d as u,f as ue,l as T,r as Ne,y as $,z as O,I as Ce,A as Z,B as x,C as ee,M as q,N as je,O as ce,P as Be,R as Le,U as Pe,V as De,W as Se,X as $e,k as ze,x as Ae,Y as He}from"./index-930d8d09.js";import{A as Ee}from"./AiOutlineCheck-df621382.js";function fe(...s){return s.filter(Boolean).join(" ")}const Me={a:{},c:'<path d="M21 11H6.414l5.293-5.293-1.414-1.414L2.586 12l7.707 7.707 1.414-1.414L6.414 13H21z"></path>'};function Oe(s){let e;return{c(){e=p("div"),e.innerHTML='<a href="#/login" class="btn-primary">Login to comment</a>',m(e,"class","flex justify-center mt-10 gap-2")},m(t,l){C(t,e,l)},p:z,i:z,o:z,d(t){t&&A(e)}}}function Ge(s){let e,t,l,n,a,o,r,i,f,d,_,h,g,k,w,H,v=s[2]&&me(s),y=s[0]&&pe();return{c(){e=p("div"),t=p("input"),l=j(),n=p("button"),n.textContent="Comment",a=j(),v&&v.c(),o=j(),r=p("div"),i=p("input"),f=j(),d=p("button"),y&&y.c(),h=j(),g=p("label"),g.textContent="Post as anonymous?",m(t,"type","text"),m(t,"class","input w-full"),m(t,"placeholder","Write a comment..."),m(n,"class","btn-primary"),m(e,"class","flex flex-col md:flex-row justify-center mt-10 gap-2"),m(i,"type","checkbox"),m(i,"id","isAnonymous"),m(i,"class","hidden"),m(d,"type","button"),m(d,"class",_=fe("w-5 h-5 rounded-md flex justify-center items-center",s[0]?"bg-blue-400":"bg-white")),m(g,"for","isAnonymous"),m(g,"class","select-none"),m(r,"class","flex items-center gap-1 my-4 cursor-pointer")},m(b,L){C(b,e,L),u(e,t),ue(t,s[1]),u(e,l),u(e,n),C(b,a,L),v&&v.m(b,L),C(b,o,L),C(b,r,L),u(r,i),i.checked=s[0],u(r,f),u(r,d),y&&y.m(d,null),u(r,h),u(r,g),k=!0,w||(H=[T(t,"input",s[6]),T(n,"click",s[4]),T(i,"change",s[7]),T(d,"click",s[8])],w=!0)},p(b,L){L&2&&t.value!==b[1]&&ue(t,b[1]),b[2]?v?v.p(b,L):(v=me(b),v.c(),v.m(o.parentNode,o)):v&&(v.d(1),v=null),L&1&&(i.checked=b[0]),b[0]?y?(y.p(b,L),L&1&&B(y,1)):(y=pe(),y.c(),B(y,1),y.m(d,null)):y&&(F(),E(y,1,1,()=>{y=null}),Q()),(!k||L&1&&_!==(_=fe("w-5 h-5 rounded-md flex justify-center items-center",b[0]?"bg-blue-400":"bg-white")))&&m(d,"class",_)},i(b){k||(B(y),k=!0)},o(b){E(y),k=!1},d(b){b&&A(e),b&&A(a),v&&v.d(b),b&&A(o),b&&A(r),y&&y.d(),w=!1,Ne(H)}}}function me(s){let e,t;return{c(){e=p("p"),t=$(s[2]),m(e,"class","text-red-500")},m(l,n){C(l,e,n),u(e,t)},p(l,n){n&4&&O(t,l[2])},d(l){l&&A(e)}}}function pe(s){let e,t;return e=new Ce({props:{src:Ee,size:16,color:"white"}}),{c(){Z(e.$$.fragment)},m(l,n){x(e,l,n),t=!0},p:z,i(l){t||(B(e.$$.fragment,l),t=!0)},o(l){E(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Ke(s){let e,t,l,n;const a=[Ge,Oe],o=[];function r(i,f){return i[3]?0:1}return t=r(s),l=o[t]=a[t](s),{c(){e=p("section"),l.c()},m(i,f){C(i,e,f),o[t].m(e,null),n=!0},p(i,[f]){let d=t;t=r(i),t===d?o[t].p(i,f):(F(),E(o[d],1,1,()=>{o[d]=null}),Q(),l=o[t],l?l.p(i,f):(l=o[t]=a[t](i),l.c()),B(l,1),l.m(e,null))},i(i){n||(B(l),n=!0)},o(i){E(l),n=!1},d(i){i&&A(e),o[t].d()}}}function Te(s,e,t){let l;ie(s,re,h=>t(3,l=h));let{postId:n=""}=e,a=!1,o="",r="";const i=async()=>{if(o.length===0){t(2,r="Comment cannot be empty");return}try{await we(R(U,"posts",n),{replies:Ie({text:o,timestamp:new Date,author:{uid:l.uid,displayName:a?"anonymous":l.displayName}})}),t(1,o="")}catch(h){console.log(h)}};function f(){o=this.value,t(1,o)}function d(){a=this.checked,t(0,a)}const _=()=>t(0,a=!a);return s.$$set=h=>{"postId"in h&&t(5,n=h.postId)},[a,o,r,l,i,n,f,d,_]}class Ve extends ne{constructor(e){super(),se(this,e,Te,Ke,oe,{postId:5})}}function de(s){let e,t,l,n;return{c(){e=p("div"),t=p("button"),t.textContent="Delete",m(t,"class","hover:underline"),m(e,"class","flex justify-end")},m(a,o){C(a,e,o),u(e,t),l||(n=T(t,"click",s[4]),l=!0)},p:z,d(a){a&&A(e),l=!1,n()}}}function We(s){let e,t,l=s[0].author.displayName+"",n,a,o,r=q(s[0].timestamp.seconds)+"",i,f,d,_=s[0].text+"",h,g,k=s[1]&&s[1].uid===s[0].author.uid&&de(s);return{c(){e=p("div"),t=p("p"),n=$(l),a=$(": "),o=p("time"),i=$(r),f=j(),d=p("p"),h=$(_),g=j(),k&&k.c(),m(t,"class","text-sm text-gray-500 mb-1"),m(e,"class","w-full h-fit bg-neutral-800 rounded-xl mt-2 py-4 px-8 relative")},m(w,H){C(w,e,H),u(e,t),u(t,n),u(t,a),u(t,o),u(o,i),u(e,f),u(e,d),u(d,h),u(e,g),k&&k.m(e,null)},p(w,[H]){H&1&&l!==(l=w[0].author.displayName+"")&&O(n,l),H&1&&r!==(r=q(w[0].timestamp.seconds)+"")&&O(i,r),H&1&&_!==(_=w[0].text+"")&&O(h,_),w[1]&&w[1].uid===w[0].author.uid?k?k.p(w,H):(k=de(w),k.c(),k.m(e,null)):k&&(k.d(1),k=null)},i:z,o:z,d(w){w&&A(e),k&&k.d()}}}function qe(s,e,t){let l;ie(s,re,i=>t(1,l=i));let{comment:n={}}=e,{postId:a=""}=e;const o=async i=>{if(confirm("Are you sure you want to delete this comment?"))try{await we(R(U,"posts",a),{replies:je(i)})}catch(d){console.log(d)}},r=()=>o(n);return s.$$set=i=>{"comment"in i&&t(0,n=i.comment),"postId"in i&&t(3,a=i.postId)},[n,l,o,a,r]}class Je extends ne{constructor(e){super(),se(this,e,qe,We,oe,{comment:0,postId:3})}}function _e(s,e,t){const l=s.slice();return l[7]=e[t],l}function he(s,e,t){const l=s.slice();return l[10]=e[t],l}function Re(s){let e;return{c(){e=p("h1"),e.textContent="Post not found",m(e,"class","text-2xl")},m(t,l){C(t,e,l)},p:z,i:z,o:z,d(t){t&&A(e)}}}function Ue(s){let e,t,l,n=s[6].title+"",a,o,r,i,f=s[6].author.displayName+"",d,_,h,g=q(s[6].createdAt.seconds)+"",k,w,H,v,y,b,L,X,Y=s[6].body+"",te,le,J,K,G,P=s[2]&&s[2].uid===s[6].author.uid&&be(s),D=s[6].updatedAt.seconds!==s[6].createdAt.seconds&&ke(s),V=s[6].topics,S=[];for(let c=0;c<V.length;c+=1)S[c]=ge(he(s,V,c));let I=s[6].replies.length>0&&ye(s);return K=new Ve({props:{postId:s[0].id}}),{c(){e=p("article"),P&&P.c(),t=j(),l=p("h1"),a=$(n),o=j(),r=p("p"),i=$("Posted by "),d=$(f),_=$(": "),h=p("time"),k=$(g),w=j(),D&&D.c(),H=j(),v=p("div");for(let c=0;c<S.length;c+=1)S[c].c();y=j(),b=p("div"),L=j(),X=p("p"),te=$(Y),le=j(),I&&I.c(),J=j(),Z(K.$$.fragment),m(l,"class","text-3xl text-center mb-4"),m(r,"class","opacity-60"),m(v,"class","flex gap-2 my-2"),m(b,"class","w-full h-[1px] my-2 bg-gray-500"),m(X,"class","leading-loose tracking-wide text-justify"),m(e,"class","md:w-[40rem] bg-neutral-800 p-6 mb-6 md:p-10 rounded-2xl")},m(c,N){C(c,e,N),P&&P.m(e,null),u(e,t),u(e,l),u(l,a),u(e,o),u(e,r),u(r,i),u(r,d),u(r,_),u(r,h),u(h,k),u(e,w),D&&D.m(e,null),u(e,H),u(e,v);for(let W=0;W<S.length;W+=1)S[W].m(v,null);u(e,y),u(e,b),u(e,L),u(e,X),u(X,te),C(c,le,N),I&&I.m(c,N),C(c,J,N),x(K,c,N),G=!0},p(c,N){if(c[2]&&c[2].uid===c[6].author.uid?P?P.p(c,N):(P=be(c),P.c(),P.m(e,t)):P&&(P.d(1),P=null),(!G||N&2)&&n!==(n=c[6].title+"")&&O(a,n),(!G||N&2)&&f!==(f=c[6].author.displayName+"")&&O(d,f),(!G||N&2)&&g!==(g=q(c[6].createdAt.seconds)+"")&&O(k,g),c[6].updatedAt.seconds!==c[6].createdAt.seconds?D?D.p(c,N):(D=ke(c),D.c(),D.m(e,H)):D&&(D.d(1),D=null),N&2){V=c[6].topics;let M;for(M=0;M<V.length;M+=1){const ae=he(c,V,M);S[M]?S[M].p(ae,N):(S[M]=ge(ae),S[M].c(),S[M].m(v,null))}for(;M<S.length;M+=1)S[M].d(1);S.length=V.length}(!G||N&2)&&Y!==(Y=c[6].body+"")&&O(te,Y),c[6].replies.length>0?I?(I.p(c,N),N&2&&B(I,1)):(I=ye(c),I.c(),B(I,1),I.m(J.parentNode,J)):I&&(F(),E(I,1,1,()=>{I=null}),Q());const W={};N&1&&(W.postId=c[0].id),K.$set(W)},i(c){G||(B(I),B(K.$$.fragment,c),G=!0)},o(c){E(I),E(K.$$.fragment,c),G=!1},d(c){c&&A(e),P&&P.d(),D&&D.d(),Ae(S,c),c&&A(le),I&&I.d(c),c&&A(J),ee(K,c)}}}function be(s){let e,t,l,n;return{c(){e=p("div"),t=p("button"),t.textContent="Delete",m(t,"class","hover:underline"),m(e,"class","flex justify-end gap-6")},m(a,o){C(a,e,o),u(e,t),l||(n=T(t,"click",s[3]),l=!0)},p:z,d(a){a&&A(e),l=!1,n()}}}function ke(s){let e,t,l,n=q(s[6].updatedAt.seconds)+"",a;return{c(){e=p("p"),t=$("Last updated: "),l=p("time"),a=$(n),m(e,"class","opacity-60")},m(o,r){C(o,e,r),u(e,t),u(e,l),u(l,a)},p(o,r){r&2&&n!==(n=q(o[6].updatedAt.seconds)+"")&&O(a,n)},d(o){o&&A(e)}}}function ge(s){let e,t=s[10]+"",l;return{c(){e=p("button"),l=$(t),m(e,"class","text-sm btn-primary px-2 py-1")},m(n,a){C(n,e,a),u(e,l)},p(n,a){a&2&&t!==(t=n[10]+"")&&O(l,t)},d(n){n&&A(e)}}}function ye(s){let e,t,l=s[6].replies.reverse(),n=[];for(let o=0;o<l.length;o+=1)n[o]=ve(_e(s,l,o));const a=o=>E(n[o],1,1,()=>{n[o]=null});return{c(){for(let o=0;o<n.length;o+=1)n[o].c();e=He()},m(o,r){for(let i=0;i<n.length;i+=1)n[i].m(o,r);C(o,e,r),t=!0},p(o,r){if(r&3){l=o[6].replies.reverse();let i;for(i=0;i<l.length;i+=1){const f=_e(o,l,i);n[i]?(n[i].p(f,r),B(n[i],1)):(n[i]=ve(f),n[i].c(),B(n[i],1),n[i].m(e.parentNode,e))}for(F(),i=l.length;i<n.length;i+=1)a(i);Q()}},i(o){if(!t){for(let r=0;r<l.length;r+=1)B(n[r]);t=!0}},o(o){n=n.filter(Boolean);for(let r=0;r<n.length;r+=1)E(n[r]);t=!1},d(o){Ae(n,o),o&&A(e)}}}function ve(s){let e,t;return e=new Je({props:{comment:s[7],postId:s[0].id}}),{c(){Z(e.$$.fragment)},m(l,n){x(e,l,n),t=!0},p(l,n){const a={};n&2&&(a.comment=l[7]),n&1&&(a.postId=l[0].id),e.$set(a)},i(l){t||(B(e.$$.fragment,l),t=!0)},o(l){E(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Xe(s){let e;return{c(){e=p("p"),e.textContent="Loading...",m(e,"class","text-2xl")},m(t,l){C(t,e,l)},p:z,i:z,o:z,d(t){t&&A(e)}}}function Ye(s){let e,t,l,n,a,o,r,i,f,d;l=new Ce({props:{src:Me,color:"white",size:"38"}});let _={ctx:s,current:null,token:null,hasCatch:!0,pending:Xe,then:Ue,catch:Re,value:6,blocks:[,,,]};return ce(r=s[1],_),{c(){e=p("div"),t=p("button"),Z(l.$$.fragment),n=j(),a=p("span"),a.textContent="Back",o=j(),_.block.c(),m(t,"class","ml-2 inline-flex"),m(e,"class","mt-10 px-4")},m(h,g){C(h,e,g),u(e,t),x(l,t,null),u(t,n),u(t,a),u(e,o),_.block.m(e,_.anchor=null),_.mount=()=>e,_.anchor=null,i=!0,f||(d=T(t,"click",Se),f=!0)},p(h,[g]){s=h,_.ctx=s,g&2&&r!==(r=s[1])&&ce(r,_)||Be(_,s,g)},i(h){i||(B(l.$$.fragment,h),B(_.block),i=!0)},o(h){E(l.$$.fragment,h);for(let g=0;g<3;g+=1){const k=_.blocks[g];E(k)}i=!1},d(h){h&&A(e),ee(l),_.block.d(),_.token=null,_=null,f=!1,d()}}}function Fe(s,e,t){let l;ie(s,re,f=>t(2,l=f));let{params:n={id:""}}=e,a=r();const o=Le(R(U,"posts",n.id),f=>{f.exists()&&t(1,a=r())});async function r(){const f=await Pe(R(U,"posts",n.id));if(f.exists())return f.data();throw new Error("Post not found")}const i=async()=>{if(confirm("Are you sure you want to delete this post?"))try{await $e(R(U,"posts",n.id)),ze("/")}catch(d){console.log(d)}};return De(o),s.$$set=f=>{"params"in f&&t(0,n=f.params)},[n,a,l,i]}class xe extends ne{constructor(e){super(),se(this,e,Fe,Ye,oe,{params:0})}}export{xe as default};
